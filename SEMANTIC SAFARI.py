import re

def is_valid_ipv4(ip):
    # Regular expression to match valid IPv4 addresses
    ipv4_pattern = re.compile(r'^(\d{1,3}\.){3}\d{1,3}$')
    return ipv4_pattern.match(ip) is not None

def is_valid_ipv6(ip):
    # Regular expression to match valid IPv6 addresses
    ipv6_pattern = re.compile(r'^([0-9a-fA-F]{0,4}:){2,7}[0-9a-fA-F]{0,4}$')
    return ipv6_pattern.match(ip) is not None

def identify_malicious_ips(ip_list):
    malicious_ips = []
    for ip in ip_list:
        if ip.startswith("92.85.") and is_valid_ipv4(ip):
            malicious_ips.append(ip)
        elif re.match(r'^2510:a5:[0-9a-fA-F]{1,4}:[0-9a-fA-F]{1,4}:[0-9a-fA-F]{1,4}:[0-9a-fA-F]{1,4}$', ip):
            malicious_ips.append(ip)
    return malicious_ips

def extract_last_characters(malicious_ips):
    last_characters = []
    for ip in malicious_ips:
        last_characters.append(ip[-1])
    return ''.join(last_characters)

# Update the file path using raw string literal
file_path = r"C:\Users\anton\PycharmProjects\pythonProject\ip_addresses.txt"

# Read IP addresses from file
with open(file_path, 'r') as file:
    ip_addresses = file.read().splitlines()

# Identify malicious IPs
malicious_ips = identify_malicious_ips(ip_addresses)

# Extract last characters of malicious IPs
flag = extract_last_characters(malicious_ips)

# Construct the flag
flag = "HQ8{" + flag + "}"

print("Flag:", flag)






# Flag: HQ8{0783b5ef55aeb6089b2fb08c4997850b978e0542a48b1d4bedcb0b32a15354ce187791c3dc6c236e2611bf56e9764323edadda665fdce62de4815a9d9f07b3775d6786befeef3e2f8483675dd65127ad5e27f116398e77360b38bd406a2312e64c9f186218511f829ae2a0c4f8d56d432c6336013640b5db2e0041376ad0f4e9d563d54fc394e054c4a8a07a3f9054403fa2117439309e7d2598ef98224b8b446851e56648837cbd3c492243f7513c7a94ce32df3ac699e55b26bb5a5cd1b393a1e9ce91b6e85c842ecf09fc7153fd9bf45585569467f450c73a18f12df9c48c55271733c786eee1507398d05dd9ecfa25dec5a33aa08d52d16dcf7c277f8ef5fdf5bc4eb9e0dde91f91fa9c853a997baf5578f08c3047e57e4ec9bb277b60f71df647f1721efe300b44a23b53e15f06db0b676db054711b6bfc94f26f59b4c2c41833724c8cd5f4b79424e82ff0f6f9d57f0d4a9535dbdaf2727df467fb6ef8e2ff919d53ae4568b7165de60757d7ab31c885c122efcd8ff37f57133fba5f67e5f8a861ab5d4a8598f83b08ace4c33eaff42f7701c155184e1c89284b5724b544a61162f2d1a7863e16fc65236e98599d4597486039a39edf92690b0ac809080b0a99fa111ace31a81a77dd3afa883969dcad101f32fb579b60cd9aa8f75f80647ddecd21697e249e0c36ecee97e2a7a3c9d6bbfad51b6ab69d60f788ee65f7d9edc249b3ea2064ae9df83578e682ba94e6c5fcf84927c8d65ebea18a6a3260671b80fa7d3f05d0e39710a8f5f643e711957ea532b826ac89cdd57666941ddb650c92db6b4b570e43a1dc3ca224ad4e9f4054a60045049f86891a4f7d2071d08cf86f0f85757ff38ad9556b35ded773aa1206fbd0c70e8d01e2dac474809912fb9992b59cd69464990d9435dfbeae12f163b4e0fd2a4eea6a1b0695a3463c63017c13bff49c86a31f60de2906aaede7c09a51a37d2f9d62cf03fc72b6af7c99b9215047ce234f7d468a8b247c0d20473621a310401656df25417b73b3bf70a2dd863a691824bffa96ef9343a9799073980566a2e9280d39e60a67fd4b3eda62866142c71a6ce48f5b893f12623f3dfd0ae23d72cfbb5461cf3d4fca6f0b22cafadf0d945ec0ff91519b7964b449075c999e78a2603065131bf2989ed4b55ed6bdda1b423e5a0b796bd05d25e2e2f28be6226bd5abb6a6505ff71947f0c37bbb98d6bce93c536800bed5cfd5b215bf306dd530b26d0d2742e7aa82a21c0e20d4cfd3cb125142fc03f7b4468a28f2cd6939d2e9564259810387dcc0f401aa12bb32fd78b662057ed0d744c785ee967c269046f2d46232140d97387324146027bb8590b390889121038d53bac47dff2153def6d55bc7de589f2deef8a6c25636f9e43884461f299eef679971f5d61985cd7d57e4c0e85d912521970b6a2f9821914f65bdfb60e9890694a18ed56fa70c086c972a9cbcac4e99f57da3f4f4c7d499d84e6fd393177920cdec4eeecebe7ca1aa1d336974afc70c1edc0e1a698c7be3fd2bff815a7188ca29e4409fa311499a6eaf7348524d41c8106df4e5beea8c01101bdcd53c0aa18ac1e0b85dd3399c12fa33d0447fcb00b5537d8fe41cc57eacca4c397293bdd7c24245078d40f0c0fc6ce2c563348180cc7921010c0a042a062e0dfb0586467bfa396e2aec20a600b62b2278e8450f8b131ac230ddee220315ddb650810a4496be27d6343caeeca39f8015a87e9e284b066ed4de87fc6ee70bdfa3d6c0d03680d26a938f44cebaa43ee261b52865d675a53f863c0f12e425a435bb3783229285b6c01de107c77a9136e3289ec182b377488b73a2758f03b5633b3dec2deb0d85d3c8e894db588c6e29240ed7025542523fe47dd39ba891b1d2e413325ca74b1d347a527aebc20545affcafa99d111adf22a0942bcde293aa017177163c95eb8f77dcfa93068cc33571463da8a84a7884981848df2508798e49acd71885a985ac72f8ad9b231d704f9bb97d427996097bd22577f31e6de0956918d76717852ae14d98d345b962aa50e1e61224e0ee19673620a988c65b08501c0582b8609137c56ac9a104ab5ecf59ecc916038101d6d53d8088d28463cd1dab389b518b95b82424a876d5d4ec9b3aa6fb6330fad297ad394c5da49bbe4b5519559e2b3c2ac0683ed21a93b72ee1fd41a89b10660d5ec4454d0734c0469333a1c19db626d9144ab45125606173f277c7b9759cc26dd043ca3de4ce1b48a32557e9de491c6536f866907837d4f829b665d4822def40d52f0f527e608a95abb186602cbe157145168d08db2fed4baff3c8f63cd50d000188a89d7dcc327667c24e4d724c38068a24639432bfee5f9059c182b8436c7d0e9df230d29b1d3a4c81af40670a1dd4e4d2fba6bad5d42aeb41bd8ae5cdbf7a894b96664bc74e1a0db155e7fe05c918245a8ee9a5fc481bb8866a0f28ba2d5c80379cb723878465648777a545f3f064e960a90c3f1838c02b5a83f1dc682c6c6316695d4c0cc8c7151353db15538da9a2a2fa81030772b7f277e9131aee99f268e2496148edc4dff07104e4ba49bb346f0baac4fa84aca187bc927cad5f5780d2cd60080d9262a3aa020c3a35a594a03b572afdd2391532b8864a42f33671157fad081020e625e8a96abfb02d93dec5c6c0d399f430828d825509ed3c8b8963ecd1e270e60c827c87094a467401d8c1a98b22a85f5d8290e495e9b09f78b0a729e58bcc04770880f08b31c97569d093db46565f28bc402ef2f58a3e70b317ae259bcf6b427715490f9117804185247ec85e082368aa6e8dd5723240c46451d50b09b7e89d0d0bcc9f0c198ecf76af16ad5d6f66319fefc32c28406da35da3628e625c1de22a1c1379009b24f7d38913006ccaf7d585ef4fe410a2deecfaff52bfa4e57d0554e00822c45c5b2f9288a84f25740f49dfe383a080304768bcab855fbba0e60a421ef1b3074d48fabcef507d7e5a2a141ba3d1ee26edb38faee3bd16ece525a3391bb00fb28fd140b26bd39f898ac242c661b335d126733c4431c5fa4353333f8207b1587579bf32f3f5249a9290b4296123e02ace31e5a0bebf4d0d37d75f69475c8e39b976d10f4b196368f0d71c42138afcdb9d68b54dd036c4a091cfd6981a6529401b4802b61664038eb3b64b8957ceeba4cc859b29cbf488706d4227b50deb45137084235b8e911bf56c698768d6d4ca662b0e2c0ef10d947966d400c6c9083b799a45039ba8c5a5141d2a2fd121b2c48d3739dfb2b3296e1a99015bd946d38e2f4c7e6440a7662e076a1f3613fdda7f754f8814384fe6f4e078c52831efbfd2c7515127869e1733d79a9031437da40e31e8661261529bc50cfe99ca2d4e7d14bacf86e2bf5bf2e52ac65bdf8bf2b3a8db81dfd0ae56509f064990e7301c0512b8e2bee0e1b06bcf34d6f65a64c820d83a4c130dda9020e90fd5fb65a59c815aaf5c4b17b08d570a82fd620a48e6d2b25033e9633936b84ff4e5e25bd11a998f4125ddb8cad993af5f09b6c661473d35c31868ac3ef8aa78bc57905cf4c46d34880624b5866c6fba404223dd3c79ec569e25a108a9d3385f211c2fea6fc21e59b50cc60c8e0e3c2e0c536439caab0f426363ba918f29b503765464f4a7253cae33e6cfd91c9edcb20d69a282e6d0f3fb1073cedda20c136327cf2b9487760b460569ff8c20ea7facf17a0753570491f40fb381bde4c023198efef56ad11be74ab2f69db28516d90ecf6979b7c7f743426cc9b8aa70b6566b467ea3a71037ebb0ae90f82c09f5921553dd63f2db809b58bab7c58f1760db2dd5e9cd3952ba9a6d9c10a5b0391d23da2c87602e817bcfec723be78f882e0f4df86de6e5f39aab83df0ccd026d35b1ec59e101708995f131025324625f2db467a8555ae2c8e0aaeb5712c7235abcc3b6ce296a90c6590913f6e4c72ab4bfd2681c63325070604b5fda3d6cf51f4b1ede620a3340f2e2c8fad8948acfc254a0cbb79a730b4fa4df3bed2e5cff9504cecd6bcceaeaa6ae8752ddfae3e19a489746e3d079b82c31268e4de53e494871e067197a1cbcd284ca9e240a833390c5cfba369b2b3a287b01208d62be2ef5bdb2d0e3cc1e1e75c4e303086035074f1dc9360f595d447546c3704a3569490d105319b8d6bf945e75bdbf2a2cf2eed582030a942802abe803f5eb3fd60b5dd818335ccde26710fcca845a97fb3acae67ebeb4399d500a3030b}

